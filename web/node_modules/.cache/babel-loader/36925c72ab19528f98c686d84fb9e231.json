{"ast":null,"code":"import Listenable from '@/lib/Listenable';\nexport default class Socket extends Listenable {\n  constructor(websocketCreator) {\n    super();\n    this.websocketCreator = websocketCreator;\n  }\n  start() {\n    if (this.ws != null) {\n      throw new Error('Websocket already started. Please stop it before starting.');\n    }\n    this.ws = this.websocketCreator();\n    this.ws.onclose = () => {\n      if (!this.isRunning()) {\n        return;\n      }\n      this.ws = null;\n      setTimeout(() => {\n        this.start();\n      }, 2000);\n    };\n    this.ws.onmessage = ({\n      data\n    }) => {\n      this.callListeners(JSON.parse(data));\n    };\n  }\n  isRunning() {\n    return this.ws != null;\n  }\n  stop() {\n    if (!this.ws) {\n      return;\n    }\n    this.ws.close();\n    delete this.ws;\n  }\n}","map":{"version":3,"names":["Listenable","Socket","constructor","websocketCreator","start","ws","Error","onclose","isRunning","setTimeout","onmessage","data","callListeners","JSON","parse","stop","close"],"sources":["/home/admin/repos/semaphore-ogs/web/src/lib/Socket.js"],"sourcesContent":["import Listenable from '@/lib/Listenable';\n\nexport default class Socket extends Listenable {\n  constructor(websocketCreator) {\n    super();\n    this.websocketCreator = websocketCreator;\n  }\n\n  start() {\n    if (this.ws != null) {\n      throw new Error('Websocket already started. Please stop it before starting.');\n    }\n    this.ws = this.websocketCreator();\n    this.ws.onclose = () => {\n      if (!this.isRunning()) {\n        return;\n      }\n      this.ws = null;\n      setTimeout(() => {\n        this.start();\n      }, 2000);\n    };\n    this.ws.onmessage = ({ data }) => {\n      this.callListeners(JSON.parse(data));\n    };\n  }\n\n  isRunning() {\n    return this.ws != null;\n  }\n\n  stop() {\n    if (!this.ws) {\n      return;\n    }\n    this.ws.close();\n    delete this.ws;\n  }\n}\n"],"mappings":"AAAA,OAAOA,UAAU,MAAM,kBAAkB;AAEzC,eAAe,MAAMC,MAAM,SAASD,UAAU,CAAC;EAC7CE,WAAWA,CAACC,gBAAgB,EAAE;IAC5B,KAAK,CAAC,CAAC;IACP,IAAI,CAACA,gBAAgB,GAAGA,gBAAgB;EAC1C;EAEAC,KAAKA,CAAA,EAAG;IACN,IAAI,IAAI,CAACC,EAAE,IAAI,IAAI,EAAE;MACnB,MAAM,IAAIC,KAAK,CAAC,4DAA4D,CAAC;IAC/E;IACA,IAAI,CAACD,EAAE,GAAG,IAAI,CAACF,gBAAgB,CAAC,CAAC;IACjC,IAAI,CAACE,EAAE,CAACE,OAAO,GAAG,MAAM;MACtB,IAAI,CAAC,IAAI,CAACC,SAAS,CAAC,CAAC,EAAE;QACrB;MACF;MACA,IAAI,CAACH,EAAE,GAAG,IAAI;MACdI,UAAU,CAAC,MAAM;QACf,IAAI,CAACL,KAAK,CAAC,CAAC;MACd,CAAC,EAAE,IAAI,CAAC;IACV,CAAC;IACD,IAAI,CAACC,EAAE,CAACK,SAAS,GAAG,CAAC;MAAEC;IAAK,CAAC,KAAK;MAChC,IAAI,CAACC,aAAa,CAACC,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,CAAC;IACtC,CAAC;EACH;EAEAH,SAASA,CAAA,EAAG;IACV,OAAO,IAAI,CAACH,EAAE,IAAI,IAAI;EACxB;EAEAU,IAAIA,CAAA,EAAG;IACL,IAAI,CAAC,IAAI,CAACV,EAAE,EAAE;MACZ;IACF;IACA,IAAI,CAACA,EAAE,CAACW,KAAK,CAAC,CAAC;IACf,OAAO,IAAI,CAACX,EAAE;EAChB;AACF","ignoreList":[]},"metadata":{},"sourceType":"module"}